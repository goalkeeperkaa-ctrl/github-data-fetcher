
# Подтверждение по OTP-коду вместо ссылки

## Что изменится

Сейчас при регистрации пользователю отправляется письмо со ссылкой для подтверждения. Мы переделаем это на **ввод 6-значного кода** (OTP), который приходит на email.

## Ограничения по кастомизации отправителя

К сожалению, на текущем тарифе Lovable Cloud используется стандартный почтовый сервер. Чтобы письма приходили от имени "Aidagis" (а не от стандартного отправителя), потребуется подключение собственного SMTP-сервера или почтового провайдера (Resend, SendGrid и т.д.). Это можно реализовать позже. Пока мы сфокусируемся на OTP-подтверждении.

---

## Шаги реализации

### 1. Изменение процесса регистрации (useAuth.tsx)
- Регистрация (`signUp`) остаётся прежней, но после неё пользователь попадает на экран ввода OTP-кода
- Добавим метод `verifyOtp(email, token)` — вызывает `supabase.auth.verifyOtp({ email, token, type: 'signup' })`

### 2. Переделка страницы авторизации (AuthPage.tsx)
- После успешной регистрации вместо сообщения "Проверьте почту" показываем форму ввода 6-значного кода
- Используем компонент `InputOTP` (уже установлен в проекте) для красивого ввода кода
- Кнопка "Подтвердить" отправляет код на проверку
- Кнопка "Отправить код повторно" для повторной отправки

### 3. Новый поток регистрации

```text
[Регистрация] --> [Ввод email, пароля, имени]
      |
      v
[Нажатие "Создать аккаунт"]
      |
      v
[Показ экрана OTP: ввод 6-значного кода]
      |
      v
[Пользователь вводит код из письма]
      |
      v
[verifyOtp() --> Успех --> Переход на главную]
```

### 4. Техническая реализация
- `useAuth.tsx`: добавить метод `verifyOtp`
- `AuthPage.tsx`: добавить состояние `pendingVerification` и экран ввода OTP с компонентом `InputOTP`
- Используем уже установленную библиотеку `input-otp` и готовый компонент `InputOTPSlot`

---

## Что НЕ входит в этот шаг
- Кастомизация отправителя письма (требует отдельной настройки SMTP) — можно сделать позже
